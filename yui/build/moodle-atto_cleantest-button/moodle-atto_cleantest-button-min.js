YUI.add("moodle-atto_cleantest-button",function(c,e){var d="atto_cleantest";c.namespace("M.atto_cleantest").Button=c.Base.create("button",c.M.editor_atto.EditorPlugin,[],{dialogue:null,initializer:function(){this.addButton({icon:"e/question",callback:this._open}).set("title",M.util.get_string("pluginname",d))},_open:function(e){e.preventDefault(),this.dialogue=this.getDialogue({modal:!1,headerContent:M.util.get_string("pluginname",d),width:"600px"});var t=c.Handlebars.compile('<div class="hide"><a class="btn btn-secondary" id="run">Run</a></div><h3>Running {{testCount}} tests</h3><div><div id="passed" class="alert alert-success alert-block">Pass</div><div id="failed" class="alert alert-danger alert-block">Fail</div></div><hr/><div id="results"></div>'),s=c.Node.create(t({testCount:this.get("tests").length}));s.one("#run").on("click",this._runTests,this),s.one("#failed").hide(),s.one("#passed").hide(),this.dialogue.set("bodyContent",s),this.dialogue.show(),this.markUpdated(),this._runTests()},_runTests:function(e){var t,s,d=c.Handlebars.compile('<div class="codetest"><div>{{#if about}}<div>{{about}}</div>{{/if}}{{#if pass}}<div class="alert alert-success alert-block" data-toggle="collapse" href="#collapse{{testNumber}}" role="button" aria-expanded="false" aria-controls="collapse{{testNumber}}" style="padding:0.25rem 1.25rem">{{testNumber}} - Pass - Click to expand<br/></div>{{else}}<div class="alert alert-danger alert-block" data-toggle="collapse" href="#collapse{{testNumber}}" role="button" aria-expanded="true" aria-controls="collapse{{testNumber}}" style="padding:0.25rem 1.25rem">{{testNumber}} - Fail</div>{{/if}}</div><div class="collapse {{#unless pass}}show{{/unless}}" id="collapse{{testNumber}}"><div><div>Input:</div><code><pre class="codeinput">{{inputCode}}</pre></code></div><div><div>Output:</div><code><pre class="codeoutput">{{outputCode}}</pre></code></div><div><div>Expected:</div><code><pre class="codeexpected">{{expectedCode}}</pre></code></div></div><hr style="margin:0.25rem"/></div>'),i=null,a=null,o=null,l=!1,n=0,r=this.get("host"),u=this.get("tests");for(t=0;t<u.length;t++)o=u[t],0==(a=r._cleanHTML(o.input,!0)).localeCompare(o.expected)?(l=!0,0):(l=!1,n++),i=c.Node.create(d({about:o.about,inputCode:o.input,outputCode:a,expectedCode:o.expected,pass:l,testNumber:t})),this.dialogue.bodyNode.one("#results").append(i);n?(s=n+" out of "+u.length+" tests failed!",this.dialogue.bodyNode.one("#failed").set("innerHTML",s),this.dialogue.bodyNode.one("#failed").show()):(s="All "+u.length+" tests passed!",this.dialogue.bodyNode.one("#passed").set("innerHTML",s),this.dialogue.bodyNode.one("#passed").show())},_setCode:function(e,t){this.dialogue.bodyNode.one("#"+e).set("innerHTML",c.Escape.html(t))}},{ATTRS:{tests:{value:null}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin","escape"]});